<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="/dist/output.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <style>
        /* Custom CSS for bounce-down animation */
        .animate-bounce-down {
            animation: bounce-down 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55) both;
        }

        @keyframes bounce-down {
            0% {
                transform: translateY(-200px);
                opacity: 0;
            }

            70% {
                transform: translateY(10px);
                opacity: 1;
            }

            100% {
                transform: translateY(0);
            }
        }
    </style>
    <title>Online Voting System</title>
</head>

<body class=" h-screen bg-gradient-to-r from-tuku-300 via-white to-green-700">
    <nav>
        <img src="/img/E.png" class="lg:w-36  sm:w-28 lg:h-24">
        <p
            class="lg:text-3xl  animate_animated animate_fadeInDown font-bold  lg:ml-62 sm:ml-24 sm:-mt-14 lg:-mt-16 sm:text-xl">
            <span class="text-tuku-300">ONLINE </span> <span class="text-gray-400">VOTING</span> <span
                class="text-green-700">PORTAL</span>
        </p>
    </nav>
    <!-- alert box -->
    <div id="myModal" class="modal absolute  inset-0 flex hidden items-center justify-center z-50 ">
        <div
            class="modal-content w-1/3 bg-gradient-to-r from-tuku-300 via-white to-green-700 rounded-xl shadow-lg p-6 animate-bounce-down">
            <h2 class="text-xl font-semibold">Do you want to vote for this candidate?</h2>
            <div class="mt-4 flex justify-end">
                <button id="saveBtn"
                    class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded mr-4">
                    Save
                </button>
                <button id="cancelBtn" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded">
                    Cancel
                </button>
            </div>
        </div>
    </div>
    <!-- personal Information -->
    <div
        class="lg:w-73 sm:w-60 sm:h-25 absolute lg:right-6 sm:ml-20 lg:h-21 lg:mt-10 sm:mt-10 rounded-xl  animate_animated animate_backInUp shadow-2xl">
        <p class="font-mono lg:ml-28 sm:ml-20 lg:text-xl">Your Id</p>
        <!-- image -->
        <form action="">
            <div class="w-28 h-28 lg:ml-24 lg:mt-6 sm:mt-3 sm:ml-16 rounded-2xl shadow-2xl">
                <img src="/img/pranab_img.jpg" id="userimage" class="h-28 rounded-2xl">
            </div>
        </form>

        <!-- Person name -->
        <form action="">
            <input type="text" id="username"
                class="w-44 sm:h-5 lg:h-6 rounded-md shadow-xl sm:ml-7 sm:mt-5 lg:ml-16 lg:mt-12 bg-transparent font-serif px-5">
        </form>

        <!-- person voter id -->
        <form action="">
            <input type="text" id="voter_id"
                class="w-44 sm:h-5 lg:h-6 rounded-md shadow-xl sm:ml-7 sm:mt-5 lg:ml-16 lg:mt-10 bg-transparent  font-serif px-8">
        </form>
    </div>
    <!-- 1st candidate section -->
    <section class=" flex lg:-mt-56">
        <div class="lg:w-52 lg:h-36 sm:w-20 sm:h-16 lg:ml-10 sm:ml-2 mt-59 ">
            <!-- candidate image -->
            <form action="">
                <img src="/img/mamata_img_bg.png" class=" sm:ml-3  rounded-lg sm:h-20 lg:w-52 lg:h-36">
            </form>
            <!-- candidate name -->
            <form action="">
                <p type="text"
                    class="justify-center flex lg:w-56 sm:w-40 bg-transparent sm:mt-2  font-semibold text-lg font-serif lg:ml-60 lg:-mt-28 px-3">
                    Mamata Banarjee</p>
            </form>
            <!-- candidate Party -->
            <form action="">
                <div
                    class="justify-center flex  lg:w-32 lg:h-10 text-2xl font-bold bg-transparent font-serif lg:ml-72  lg:mt-6 px-9">
                    TMC </div>
            </form>
            <img src="/img/tmc_logo.png" class="lg:w-28 sm:w-14 flex lg:ml-120 -mt-32">
            <button id="openModalBtn1"
                class="button  h-14 lg:ml-50  cursor-pointer select-none
                active:translate-y-2  active:[box-shadow:0_0px_0_0_#1b6ff8,0_0px_0_0_#1b70f841]
                active:border-b-[0px]
                transition-all duration-150 [box-shadow:0_10px_0_0_#1b6ff8,0_15px_0_0_#1b70f841]
                rounded-full  border-[1px] border-black  lg:-mt-24 flex  w-36 lg:mx-80 py-4  px-12  font-bold bg-green-300 shadow-purple-500  sm:mx-2 text-black">VOTE</button>
        </div>
    </section>

    <!-- 2nd candidate -->

    <section class=" flex lg:-mt-72">
        <div class="lg:w-52 lg:h-36 sm:w-20 sm:h-16 lg:ml-10 sm:ml-2 mt-59 ">
            <!-- candidate image -->
            <form action="">
                <img src="/img/suvendu_img_bg.png" class="  rounded-lg sm:h-16 lg:w-52 lg:h-36">
            </form>
            <!-- candidate name -->
            <form action="">
                <p type="text"
                    class="justify-center flex  lg:w-56 sm:w-40 bg-transparent text-lg  font-semibold font-serif lg:ml-60 lg:-mt-28 px-3">
                    Suvendu Adhikari</p>
            </form>
            <!-- candidate Party -->
            <form action="">
                <div
                    class="justify-center flex  lg:w-32 lg:h-10 text-2xl font-bold bg-transparent font-serif lg:ml-72  lg:mt-6 px-9">
                    BJP </div>
            </form>
            <img src="/img/bjp_logo.png" class="lg:w-36 flex lg:ml-120 -mt-36">
            <button id="openModalBtn2"
                class="button  lg:visible h-14 lg:ml-50  cursor-pointer select-none
                active:translate-y-2  active:[box-shadow:0_0px_0_0_#1b6ff8,0_0px_0_0_#1b70f841]
                active:border-b-[0px]
                transition-all duration-150 [box-shadow:0_10px_0_0_#1b6ff8,0_15px_0_0_#1b70f841]
                rounded-full  border-[1px] border-black  lg:-mt-24 flex  lg:w-36 lg:mx-80 py-4  px-12  font-bold bg-green-300 shadow-purple-500  sm:mx-2 text-black">VOTE</button>
        </div>
    </section>

    <!-- 3 candidate -->
    <section class=" flex lg:-mt-72">
        <div class="lg:w-52 lg:h-36 sm:w-20 sm:h-16 lg:ml-10 sm:ml-2 mt-59 ">
            <!-- candidate image -->
            <form action="">
                <img src="/img/mina_img_bg.png" class="sm:w-20  rounded-lg sm:h-16 lg:w-52 lg:h-36">
            </form>
            <!-- candidate name -->
            <form action="">
                <p type="text"
                    class="justify-center flex  lg:w-56 sm:w-40 bg-transparent text-lg font-semibold font-serif lg:ml-60 lg:-mt-28 px-3">
                    Minakshi Mukherjee</p>
            </form>
            <!-- candidate Party -->
            <form action="">
                <div
                    class="justify-center flex  lg:w-32 lg:h-10 text-2xl font-bold bg-transparent font-serif lg:ml-72  lg:mt-6 px-9">
                    CPIM </div>
            </form>
            <img src="/img/cpim_logo.png" class="lg:w-36 flex lg:ml-120 -mt-32">
            <button id="openModalBtn3"
                class="button  h-14 lg:ml-50  cursor-pointer select-none
                active:translate-y-2  active:[box-shadow:0_0px_0_0_#1b6ff8,0_0px_0_0_#1b70f841]
                active:border-b-[0px]
                transition-all duration-150 [box-shadow:0_10px_0_0_#1b6ff8,0_15px_0_0_#1b70f841]
                rounded-full  border-[1px] border-black  lg:-mt-24 flex  w-36 lg:mx-80 py-4  px-12  font-bold bg-green-300 shadow-purple-500  sm:mx-2 text-black">VOTE</button>
        </div>
    </section>

    <script>
        const openModalBtn1 = document.getElementById("openModalBtn1");
        const openModalBtn2 = document.getElementById("openModalBtn2");
        const openModalBtn3 = document.getElementById("openModalBtn3");
        const closeModalBtn = document.getElementById("cancelBtn");
        const modal = document.getElementById("myModal");
        const saveBtn = document.getElementById('saveBtn')
        let Cname = ''

        window.addEventListener('load', (e) => {
            let username = document.getElementById('username');
            let voter = document.getElementById('voter_id');
            let userimage = document.getElementById('userimage');
            let userData = localStorage.getItem('userData')
            userData = JSON.parse(userData);
            console.log(userData)

            username.value = userData.name,
                voter.value = userData.voter_id
            userimage.src = userData.image
        })

        const showModal = () => {
            modal.classList.remove("hidden");
        };

        const closeModal = () => {
            modal.classList.add("hidden");
        };

        openModalBtn1.addEventListener("click", () => {
            Cname = 'Mamata Banarjee'
            showModal();
        });

        openModalBtn2.addEventListener("click", () => {
            Cname = 'Suvendu Adhikari'
            showModal();
        });

        openModalBtn3.addEventListener("click", () => {
            Cname = 'Minakshi Mukherjee'
            showModal();
        });

        closeModalBtn.addEventListener("click", () => {
            Cname = ''
            closeModal();
        });


        saveBtn.addEventListener('click', (e) => {
            let userData = localStorage.getItem('userData')
            userData = JSON.parse(userData);
            giveVote(userData, Cname)
        })

        async function giveVote(data, Cname) {
            try {
                const res = await fetch('/vote', {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify({
                        adhaar_id: data.aadhar_id,
                        voter_id: data.voter_id,
                        voter_name: data.name,
                        candidate_name: Cname
                    }),
                })

                const resdata = await res.json()
                if (resdata.error) {
                    alert(resdata.message)
                } else {
                    window.location.href = "https://online-votting-system.onrender.com/success"
                }
                console.log(resdata)

            } catch (error) {
                console.log(error)
            }
        }

    </script>
</body>

</html>
